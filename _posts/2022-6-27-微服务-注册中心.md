## 微服务：注册中心

#### 1、为什么需要服务注册中心
`微服务`时代的服务管理

在微服务时代，我们所有的服务都被劲量拆分成最小的粒度，原先所有的服务都在混在1个server里，现在就被按照功能或者对象拆分成N个服务模块，这样做的好处是**深度解耦**，1个模块只负责自己的事情就好，**能够实现快速的迭代更新。坏处就是服务的管理和控制变得异常的复杂和繁琐，**人工维护难度变大。还有排查问题和性能变差（服务调用时的网络开销）

#### 2、什么是注册中心？
注册中心的作用一句话概括就是**存放和调度服务**，实现服务和注册中心，服务和服务之间的相互通信。注册中心可以说是微服务架构中的”通讯录“，它记录了服务和服务地址的映射关系。在分布式架构中，服务会注册到这里，当服务需要调用其它服务时，就到这里找到服务的地址，进行调用。

**如果没有注册中心？会怎样**

```
 在不用服务注册之前，怎么去维护这种复制的关系网络呢？答案就是：写死！。
```

1. 将其他模块的ip和端口写死在自己的配置文件里，甚至写死在代码里，每次要去新增或者移除1个服务的实例的时候，就得去通知其他所有相关联的服务去修改。

2. 随之而来的就是各个项目的配置文件的反复更新、每隔一段时间大规模的ip修改和机器裁撤，非常的痛苦。

而有了注册中心之后，每个服务在调用别人的时候只需要服务的名称就好，调用时会通过注册中心根据服务编码进行具体服务地址进行调用。

**常用的注册中心中间件**

| 特性            | Eureka      | Nacos                      | Consul            | Zookeeper  |
| --------------- | ----------- | -------------------------- | ----------------- | ---------- |
| CAP             | AP          | CP + AP                    | CP                | CP         |
| 健康检查        | Client Beat | TCP/HTTP/MYSQL/Client Beat | TCP/HTTP/gRPC/Cmd | Keep Alive |
| 雪崩保护        | 有          | 有                         | 无                | 无         |
| 自动注销实例    | 支持        | 支持                       | 不支持            | 支持       |
| 访问协议        | HTTP        | HTTP/DNS                   | HTTP/DNS          | TCP        |
| 监听支持        | 支持        | 支持                       | 支持              | 支持       |
| 多数据中心      | 支持        | 支持                       | 支持              | 不支持     |
| 跨注册中心同步  | 不支持      | 支持                       | 支持              | 不支持     |
| SpringCloud集成 | 支持        | 支持                       | 支持              | 支持       |

#### 3、服务注册中心的作用

**服务注册中心的作用就是【服务的注册】和【服务的发现】**

- 服务注册，就是将提供某个服务的模块信息(通常是这个服务的ip和端口)注册到1个公共的组件上去（比如: zookeeper\consul）。

- 服务发现，就是新注册的这个服务模块能够及时的被其他调用者发现。不管是服务新增和服务删减都能实现自动发现。



（1）可以对服务进行统一管理，发现服务，注册服务等。比如对某一个服务进行停用，这样我们不必直接在项目中进行修改。而且注册中心一般有通信机制，如心跳检测，如果某个微服务长时间没有通信，那么就会销毁该实例

（2）解耦作用。因为注册中心作为中间方，服务调用方只需要知道服务是否存在，而不关心服务的其他配置，如果不用注册中心，那我调用某个服务（接口）是需要和后端明确统一地址和端口的。